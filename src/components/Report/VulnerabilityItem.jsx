// src/components/Report/VulnerabilityItem.jsx
import React from "react";
import ReactMarkdown from "react-markdown";
import "../../styles/VulnerabilityItem.css"; // Create this CSS file

const VulnerabilityItem = ({ vulnerability }) => {
  return (
    <div className="vulnerability-item-card">
      <div className="file-info-header">
        <h3 className="file-name">{vulnerability?.file_name}</h3>
        <span className="file-meta">
          Type: {vulnerability?.file_type} - LOC: {vulnerability?.loc}
        </span>
        {vulnerability?.file_path && vulnerability?.file_path !== "#" && (
          <a
            href={vulnerability?.file_path}
            target="_blank"
            rel="noopener noreferrer"
            className="view-file-link"
          >
            View File
          </a>
        )}
      </div>

      <div className="vulnerability-details">
        {vulnerability?.cwe_details?.name && (
          <p className="vulnerability-name">
            <strong>{vulnerability?.cwe_details?.name}</strong>
          </p>
        )}
        <p className="detail-item">
          <span className="detail-label">Lines:</span>{" "}
          {vulnerability?.line_from} - {vulnerability?.line_to}
        </p>
        <p className="detail-item">
          <span className="detail-label">Description:</span>{" "}
          {vulnerability?.cwe_details?.description}
        </p>
        {vulnerability?.code && (
          <div className="code-snippet-container">
            <span className="detail-label">Code Snippet:</span>
            <pre className="code-snippet">
              <code>{vulnerability?.code}</code>
            </pre>
          </div>
        )}
        <div className="suggestion-container">
          <h4 className="suggestion-title">Suggestion:</h4>
          <div className="suggestion-text markdown-content">
            <ReactMarkdown>
              {vulnerability?.cwe_details?.generic_fix ||
                vulnerability?.vuln_description ||
                "No specific suggestion available."}
            </ReactMarkdown>
          </div>
        </div>
      </div>
    </div>
  );
};

export default VulnerabilityItem;
